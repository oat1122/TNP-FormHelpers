<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê TNP Pricing Integration - Access Control API Tester</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
        }
        input, select, button {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 0;
        }
        button:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .result {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .success { border-color: #27ae60; background: #d5f4e6; }
        .error { border-color: #e74c3c; background: #fdeaea; }
        .info { border-color: #f39c12; background: #fef5e7; }
        .access-info {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .user-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        .user-selector button {
            flex: 1;
            padding: 10px;
            background: #95a5a6;
        }
        .user-selector button.active {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê TNP Pricing Integration - Access Control API Tester</h1>
        
        <div class="access-info">
            <h3>üîç ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á</h3>
            <p><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Access Control ‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡πà‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° <code>cus_manage_by</code></p>
            <ul>
                <li><strong>Admin (user_id = 1):</strong> ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
                <li><strong>User ‡∏≠‡∏∑‡πà‡∏ô‡πÜ:</strong> ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏î‡∏π‡πÅ‡∏• (cus_manage_by = user_id)</li>
            </ul>
        </div>

        <!-- Base URL Configuration -->
        <div class="test-section">
            <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
            <div class="form-group">
                <label for="baseUrl">Base URL:</label>
                <input type="text" id="baseUrl" value="http://localhost:8000/api/v1" placeholder="http://localhost:8000/api/v1">
            </div>
        </div>

        <!-- User Selection -->
        <div class="test-section">
            <h3>üë§ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
            <div class="user-selector">
                <button onclick="selectUser('admin', '1', 'admin-uuid')" id="adminBtn">üëë Admin (user_id: 1)</button>
                <button onclick="selectUser('sales1', '2', 'sales1-uuid')" id="sales1Btn">üë®‚Äçüíº Sales 1 (user_id: 2)</button>
                <button onclick="selectUser('sales2', '3', 'sales2-uuid')" id="sales2Btn">üë©‚Äçüíº Sales 2 (user_id: 3)</button>
            </div>
            <div class="form-group">
                <label for="selectedUser">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</label>
                <input type="text" id="selectedUser" readonly placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
            </div>
            <div class="form-group">
                <label for="userUuid">User UUID:</label>
                <input type="text" id="userUuid" readonly placeholder="UUID ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
            </div>
        </div>

        <!-- Test Pricing Requests API -->
        <div class="test-section">
            <h3>üìã ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Pricing Requests API</h3>
            <div class="form-group">
                <label for="customerId">Customer ID (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ - ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î):</label>
                <input type="number" id="customerId" placeholder="‡πÄ‡∏ä‡πà‡∏ô 123">
            </div>
            <button onclick="testPricingRequests()">üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö GET /pricing-requests</button>
            <div id="pricingResult" class="result"></div>
        </div>

        <!-- Test Customer Search API -->
        <div class="test-section">
            <h3>üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Customer Search API</h3>
            <div class="form-group">
                <label for="searchQuery">‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</label>
                <input type="text" id="searchQuery" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤" value="test">
            </div>
            <button onclick="testCustomerSearch()">üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö GET /customers/search</button>
            <div id="searchResult" class="result"></div>
        </div>

        <!-- Test Customer Details API -->
        <div class="test-section">
            <h3>üìù ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Customer Details API</h3>
            <div class="form-group">
                <label for="customerDetailId">Customer ID:</label>
                <input type="number" id="customerDetailId" placeholder="‡πÄ‡∏ä‡πà‡∏ô 123" value="123">
            </div>
            <button onclick="testCustomerDetails()">üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö GET /customers/{id}/details</button>
            <div id="detailsResult" class="result"></div>
        </div>

        <!-- Summary -->
        <div class="test-section">
            <h3>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
            <div id="testSummary" class="result info">
                ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let testResults = [];

        // User selection
        function selectUser(userType, userId, userUuid) {
            currentUser = { userType, userId, userUuid };
            
            // Update UI
            document.getElementById('selectedUser').value = `${userType} (ID: ${userId})`;
            document.getElementById('userUuid').value = userUuid;
            
            // Update button states
            document.querySelectorAll('.user-selector button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`${userType}Btn`).classList.add('active');
            
            // Reset results
            document.getElementById('testSummary').textContent = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${userType} (ID: ${userId}) - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö`;
            testResults = [];
        }

        // Make API request with proper headers
        async function makeRequest(url, method = 'GET', body = null) {
            try {
                const options = {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                    }
                };

                if (body) {
                    options.body = JSON.stringify(body);
                }

                console.log(`üåê Making ${method} request to: ${url}`);
                
                const response = await fetch(url, options);
                const data = await response.json();
                
                return {
                    success: response.ok,
                    status: response.status,
                    data: data,
                    url: url
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message,
                    url: url
                };
            }
        }

        // Test Pricing Requests API
        async function testPricingRequests() {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                return;
            }

            const baseUrl = document.getElementById('baseUrl').value;
            const customerId = document.getElementById('customerId').value;
            const resultDiv = document.getElementById('pricingResult');
            
            resultDiv.innerHTML = 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö Pricing Requests API...';
            
            // Build URL with parameters
            let url = `${baseUrl}/pricing-requests?user=${currentUser.userUuid}`;
            if (customerId) {
                url += `&customer_id=${customerId}`;
            }
            
            const result = await makeRequest(url);
            
            let resultText = `üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Pricing Requests API\n`;
            resultText += `üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${currentUser.userType} (ID: ${currentUser.userId})\n`;
            resultText += `üåê URL: ${result.url}\n`;
            resultText += `üìà Status: ${result.status}\n\n`;
            
            if (result.success && result.data.success) {
                const dataCount = result.data.data?.length || 0;
                resultText += `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n`;
                resultText += `üìã ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${dataCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n`;
                
                if (dataCount > 0) {
                    resultText += `üìù ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:\n`;
                    const sample = result.data.data[0];
                    resultText += `- PR ID: ${sample.pr_id}\n`;
                    resultText += `- ‡∏á‡∏≤‡∏ô: ${sample.pr_work_name}\n`;
                    resultText += `- ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${sample.customer?.cus_company || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\n`;
                    resultText += `- Customer ID: ${sample.customer?.cus_id || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}\n`;
                }
                
                resultDiv.className = 'result success';
                testResults.push({
                    api: 'Pricing Requests',
                    user: currentUser.userType,
                    status: 'SUCCESS',
                    count: dataCount
                });
            } else {
                resultText += `‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß!\n`;
                resultText += `üìÑ Response: ${JSON.stringify(result.data, null, 2)}`;
                resultDiv.className = 'result error';
                testResults.push({
                    api: 'Pricing Requests',
                    user: currentUser.userType,
                    status: 'FAILED',
                    error: result.data?.message || result.error
                });
            }
            
            resultDiv.textContent = resultText;
            updateTestSummary();
        }

        // Test Customer Search API
        async function testCustomerSearch() {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                return;
            }

            const baseUrl = document.getElementById('baseUrl').value;
            const searchQuery = document.getElementById('searchQuery').value;
            const resultDiv = document.getElementById('searchResult');
            
            if (!searchQuery || searchQuery.length < 2) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
                return;
            }
            
            resultDiv.innerHTML = 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö Customer Search API...';
            
            const url = `${baseUrl}/customers/search?q=${encodeURIComponent(searchQuery)}&user=${currentUser.userUuid}`;
            const result = await makeRequest(url);
            
            let resultText = `üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Customer Search API\n`;
            resultText += `üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${currentUser.userType} (ID: ${currentUser.userId})\n`;
            resultText += `üîç ‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: "${searchQuery}"\n`;
            resultText += `üåê URL: ${result.url}\n`;
            resultText += `üìà Status: ${result.status}\n\n`;
            
            if (result.success && result.data.success) {
                const dataCount = result.data.data?.length || 0;
                resultText += `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n`;
                resultText += `üë• ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${dataCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n`;
                
                if (dataCount > 0) {
                    resultText += `üìù ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö:\n`;
                    result.data.data.forEach((customer, index) => {
                        resultText += `${index + 1}. ${customer.cus_company} (ID: ${customer.cus_id})\n`;
                    });
                }
                
                resultDiv.className = 'result success';
                testResults.push({
                    api: 'Customer Search',
                    user: currentUser.userType,
                    status: 'SUCCESS',
                    count: dataCount
                });
            } else {
                resultText += `‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß!\n`;
                resultText += `üìÑ Response: ${JSON.stringify(result.data, null, 2)}`;
                resultDiv.className = 'result error';
                testResults.push({
                    api: 'Customer Search',
                    user: currentUser.userType,
                    status: 'FAILED',
                    error: result.data?.message || result.error
                });
            }
            
            resultDiv.textContent = resultText;
            updateTestSummary();
        }

        // Test Customer Details API
        async function testCustomerDetails() {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                return;
            }

            const baseUrl = document.getElementById('baseUrl').value;
            const customerId = document.getElementById('customerDetailId').value;
            const resultDiv = document.getElementById('detailsResult');
            
            if (!customerId) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Customer ID');
                return;
            }
            
            resultDiv.innerHTML = 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö Customer Details API...';
            
            const url = `${baseUrl}/customers/${customerId}/details?user=${currentUser.userUuid}`;
            const result = await makeRequest(url);
            
            let resultText = `üìù ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Customer Details API\n`;
            resultText += `üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${currentUser.userType} (ID: ${currentUser.userId})\n`;
            resultText += `üè¢ Customer ID: ${customerId}\n`;
            resultText += `üåê URL: ${result.url}\n`;
            resultText += `üìà Status: ${result.status}\n\n`;
            
            if (result.success && result.data.success) {
                const customer = result.data.data;
                resultText += `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n`;
                resultText += `üè¢ ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó: ${customer.cus_company}\n`;
                resultText += `üìß ‡∏≠‡∏µ‡πÄ‡∏°‡∏•: ${customer.cus_email}\n`;
                resultText += `üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${customer.cus_tel_1}\n`;
                resultText += `üìä Pricing Requests ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${customer.recent_pricing_requests?.length || 0} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;
                
                resultDiv.className = 'result success';
                testResults.push({
                    api: 'Customer Details',
                    user: currentUser.userType,
                    status: 'SUCCESS',
                    customer: customer.cus_company
                });
            } else {
                resultText += `‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß!\n`;
                resultText += `üìÑ Response: ${JSON.stringify(result.data, null, 2)}`;
                resultDiv.className = 'result error';
                testResults.push({
                    api: 'Customer Details',
                    user: currentUser.userType,
                    status: 'FAILED',
                    error: result.data?.message || result.error
                });
            }
            
            resultDiv.textContent = resultText;
            updateTestSummary();
        }

        // Update test summary
        function updateTestSummary() {
            const summaryDiv = document.getElementById('testSummary');
            
            if (testResults.length === 0) {
                summaryDiv.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö';
                return;
            }
            
            let summary = `üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö (${testResults.length} ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö)\n\n`;
            
            testResults.forEach((result, index) => {
                summary += `${index + 1}. ${result.api} (${result.user}): `;
                if (result.status === 'SUCCESS') {
                    summary += `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`;
                    if (result.count !== undefined) {
                        summary += ` (${result.count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`;
                    }
                    if (result.customer) {
                        summary += ` - ${result.customer}`;
                    }
                } else {
                    summary += `‚ùå ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß - ${result.error}`;
                }
                summary += `\n`;
            });
            
            // Analysis
            summary += `\nüîç ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:\n`;
            const adminResults = testResults.filter(r => r.user === 'admin');
            const salesResults = testResults.filter(r => r.user.startsWith('sales'));
            
            if (adminResults.length > 0) {
                const adminSuccess = adminResults.filter(r => r.status === 'SUCCESS');
                summary += `üëë Admin: ${adminSuccess.length}/${adminResults.length} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n`;
            }
            
            if (salesResults.length > 0) {
                const salesSuccess = salesResults.filter(r => r.status === 'SUCCESS');
                summary += `üë®‚Äçüíº Sales Users: ${salesSuccess.length}/${salesResults.length} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n`;
            }
            
            summaryDiv.textContent = summary;
            summaryDiv.className = 'result info';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîê TNP Pricing Integration - Access Control API Tester initialized');
        });
    </script>
</body>
</html>
