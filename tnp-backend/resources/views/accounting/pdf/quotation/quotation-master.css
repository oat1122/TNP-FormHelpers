/* ===== Base ===== */
body{
  font-family:'thsarabun','DejaVu Sans',sans-serif;
  font-size:11pt; /* ลดลงให้ดูกะทัดรัด */
  line-height:1.35;
  color:#333;
  margin:0;
  padding:20pt;
}

h1{font-size:20pt;font-weight:bold;margin:0 0 8pt;color:#2c3e50}
h2{font-size:16pt;font-weight:bold;margin:12pt 0 6pt;color:#34495e}
h3{font-size:13pt;font-weight:bold;margin:10pt 0 6pt;color:#34495e}

/* ===== Reset any potential Bootstrap conflicts ===== */
* {
  box-sizing: border-box;
}

.clearfix:after {
  content: "";
  display: table;
  clear: both;
}

/* ===== Info Box ===== */
.info-box{
  background:#f8f9fa;
  border:1px solid #e9ecef;
  border-radius:6pt;
  padding:12pt;
  margin-bottom:15pt;
  width:100%;
}

.info-box table {
  width: 100%;
  border-collapse: collapse;
}

.info-box td {
  padding: 4pt 8pt;
  vertical-align: top;
}

/* ===== Tables ===== */
table{
  border-collapse:collapse;
  width:100%;
  margin-bottom: 15pt;
}

/* Items table */
.items-table th,.items-table td{
  padding:6pt 8pt;
  border: 1px solid #dee2e6;
}

.items-table thead th{
  border-bottom:2px solid #9fb3c8;
  background:#eef2f5;
  text-align:center;
  font-weight: bold;
}

.items-table .num{width:7%;text-align:center}
.items-table .desc{width:53%}
.items-table .qty{width:14%;text-align:center}
.items-table .price{width:13%;text-align:right}
.items-table .amount{width:13%;text-align:right}

/* Group styling */
.group-body{page-break-inside:avoid}
.group-box{
  page-break-inside:avoid;
  border: 1px solid #e5edf5;
  margin: 5pt 0;
}

.group-inner{
  width:100%;
  border-collapse:collapse;
}

.group-inner td{
  padding:6pt 8pt;
  border-bottom: 1px solid #f0f0f0;
}

.group-inner .title{
  font-weight:bold;
  background:#fafbfc;
  border-top:2px solid #dee5ed;
  border-bottom:1px solid #e3e9ef;
}

.meta-light{color:#6e7b88;font-weight:normal}

/* ===== Signature Section ===== */
.signature-section{
  margin-top:36pt;
  page-break-inside:avoid;
  width: 100%;
}

.signature-table {
  width: 100%;
  border-collapse: collapse;
}

.signature-cell {
  width: 50%;
  text-align: center;
  vertical-align: top;
  padding: 12pt;
}

.signature-box{
  width:200pt;
  height:60pt;
  border-bottom:1pt solid #333;
  margin-bottom:8pt;
  display:block;
  margin-left:auto;
  margin-right:auto;
}

/* Fixed signature (drawn by mPDF at bottom) */
.signature-fixed-wrapper { font-size:10pt; }
.signature-table.fixed { width:100%; border-collapse:collapse; }
.signature-table.fixed .signature-cell { padding:6pt 12pt; }
.signature-table.fixed .signature-role { font-weight:600; margin-top:6pt; font-size:10.5pt; color:#2c3e50; line-height:1.35; }
.signature-table.fixed .signature-name-placeholder { margin-top:8pt; font-size:9pt; color:#555; font-style:italic; line-height:1.4; }
.signature-table.fixed .signature-date-line { margin-top:8pt; font-size:8.5pt; color:#444; letter-spacing:.5pt; line-height:1.4; }
.signature-hint { margin-top:4pt; text-align:center; font-size:7.5pt; }
.signature-box { position:relative; }
.signature-box:after { content:""; position:absolute; left:0; right:0; bottom:-2pt; height:0; border-bottom:1pt solid #555; }
.signature-cell { position:relative; }
.signature-cell:not(:last-child) { border-right:none; }
.signature-fixed-wrapper { border:none; border-radius:0; padding:10pt 6pt 6pt; background:transparent; }

/* Spacer to reserve vertical space so body content doesn't collide with fixed signature */
.signature-spacer { height:12mm; /* minimal reserve; bottom signature now absolute via SetY */ }

/* ===== Utility Classes ===== */
.text-right{text-align:right}
.text-center{text-align:center}
.text-muted{color:#6c757d}
.mb-3{margin-bottom:12pt}
.mb-4{margin-bottom:16pt}
.mt-4{margin-top:16pt}

/* Prevent page breaks in critical sections */
thead{display:table-header-group}
tfoot{display:table-footer-group}
tr{page-break-inside:avoid}

/* === ตารางแบบรูปที่ 2 (Minimal lines) === */
.items-table.slim th,
.items-table.slim td {
  padding: 5pt 5pt;
  border: none;                 /* ตัดกรอบเซลล์เดิม */
  background: transparent;
  vertical-align: top;
  font-size: 10pt;              /* ลดขนาดตัวอักษร */
}

.items-table.slim thead th {
  font-weight: bold;
  text-align: right;
  border-bottom: 0.6pt solid #666;  /* เส้นคั่นหัวตารางแบบบาง */
  font-size: 11pt;              /* หัวตารางใหญ่กว่าเนื้อหาเล็กน้อย */
}
.items-table.slim thead th:first-child { text-align: left; }

.items-table.slim .desc { text-align: left; }
.items-table.slim .num  { text-align: right; white-space: nowrap; }
.items-table.slim .muted{ color:#888; }

/* หัวข้อกลุ่ม (parent) */
.items-table.slim .group-row td {
  font-weight: bold;
  padding-top: 8pt;
  padding-bottom: 5pt;
  border-bottom: 0.6pt solid #999;   /* เส้นคั่นใต้หัวข้อ */
  font-size: 11pt;               /* หัวข้อกลุ่มใหญ่กว่าข้อมูลเล็กน้อย */
  background-color: #f8f9fa;    /* สีพื้นหลังอ่อนๆ */
}

/* แถวรายการย่อย (child) */
.items-table.slim .item-row td {
  padding-top: 6pt;
  padding-bottom: 6pt;
  border-bottom: 0.6pt solid #ddd;   /* เส้นคั่นใต้รายการ */
  font-size: 10pt;               /* ข้อมูลรายการย่อย */
}
.items-table.slim .desc.child { 
  padding-left: 16pt;            /* เพิ่มการย่อหน้าให้มากขึ้น */
  text-indent: 0;                /* ไม่ใช้ text-indent */
}

/* กล่องข้อมูลลูกค้าแบบบล็อก */
.customer-box{
  border-radius:6pt;
  padding:12pt;
  margin-top:-6pt;        /* ยกกล่องขึ้นเล็กน้อย ลดช่องว่างหลัง header */
}
.customer-name{
  font-weight:bold;
  font-size:12pt;          /* ให้ตามหัวบริษัทใหม่ */
  color:#2c3e50;
  margin-bottom:2pt;
}
.customer-line{
  font-size:9pt;           /* ให้ตาม company-addr */
  color:#34495e;
  margin:2pt 0;
  line-height:1.34;
}
.customer-line.muted{ color:#6c757d; }

/* === Compact overrides === */
.table-numbers-sm td.num,
.table-numbers-sm th.text-right { font-size:10pt !important; }

.items-table.slim.table-numbers-sm td.desc { font-size:10.5pt; }

/* No items box */
.no-items-box { text-align:center; padding:20pt; border:1px solid #dee2e6; background:#f8f9fa; }

/* Column width helpers for items table */
col.w-desc { width:60%; }
col.w-unit-price { width:15%; }
col.w-qty { width:10%; }
col.w-total { width:15%; }

/* Signature spacing utility */
.mt-8 { margin-top:8pt !important; }

/* ===== สำหรับ mPDF - แก้ไขปัญหาตัวเลขตกและคำอ่านล้น ===== */

/* === Layout: Summary & Notes (table variant) === */
.summary-notes-wrapper { 
  page-break-inside: auto; 
  margin-top: 15pt; 
  width: 100%;
}

.summary-notes-table { 
  width: 100%; 
  border-collapse: separate; 
  border-spacing: 8pt 0;
  table-layout: fixed; /* บังคับให้ใช้ width ที่กำหนด */
}

/* Panels */
.panel-box { 
  vertical-align: top; 
  padding: 6pt 4pt; 
  border: none; 
  background: transparent; 
  overflow: hidden;
}

.panel-notes { 
  background: transparent; 
  width: 40% !important;
}

.panel-box:last-child {
  width: 55% !important;
}

.panel-title { 
  font-size: 12pt; 
  font-weight: 600; 
  margin: 0 0 4pt; 
  color: #2f3d48; 
}

.panel-title--sm { 
  font-size: 11pt; 
}

.panel-title.center { 
  text-align: center; 
}

.panel-content { 
  font-size: 9.5pt; 
  line-height: 1.35; 
  color: #555; 
}

/* ===== Summary Table - แก้ไขหลักสำหรับ mPDF ===== */
.summary-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 10pt;
  table-layout: fixed;
}

.summary-table td {
  padding: 5pt 6pt;
  border-bottom: 1px solid #dee2e6;
  vertical-align: top;
  word-wrap: break-word;
}

/* ปรับสัดส่วน column ใหม่สำหรับ mPDF */
.summary-table .summary-label {
  text-align: left;
  width: 45% !important;
  font-size: 10pt;
}

.summary-table .summary-amount {
  text-align: right;
  width: 55% !important;
  font-weight: bold;
  font-size: 10pt;
  padding-left: 8pt;
}

/* แก้ไขการแสดงผลตัวเลขสำหรับ mPDF */
.summary-amount .amount-main { 
  white-space: nowrap !important;
  display: block;
  font-size: 10pt;
  overflow: hidden;
}

/* แก้ไขคำอ่านภาษาไทยสำหรับ mPDF */
.reading {
  color: #6c757d;
  font-size: 8pt !important;
  margin-top: 2pt;
  font-style: italic;
  display: block;
  line-height: 1.1 !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  max-width: 100%;
  hyphens: auto;
}

/* Financial row styling */
.summary-table .discount-row {
  color: #d32f2f; /* Red for discounts */
}

.summary-table .withholding-tax-row {
  color: #f57c00; /* Orange for withholding tax */
}

.summary-table .deposit-row {
  color: #388e3c; /* Green for deposits */
  font-style: italic;
}



.summary-table .summary-amount.deposit {
  color: #388e3c;
}

/* Total row styling */
.summary-table .total-row { 
  background: transparent; 
  border-top: 1.5pt solid #d0d7dd;
}

.summary-table .total-row td { 
  font-weight: 600; 
  color: #1e4d79; 
  padding: 8pt 6pt;
  font-size: 10.5pt;
}

.summary-table .total-row .summary-amount { 
  font-size: 10.5pt;
}

.summary-table .total-row .reading {
  font-size: 7.5pt !important;
  color: #1e4d79;
  opacity: 0.8;
  line-height: 1.0 !important;
}

/* ===== เพิ่ม CSS สำหรับแถวคำอ่านที่แยกออกมา ===== */
/* แถวคำอ่าน - แยกออกจากตัวเลข */
.summary-table .reading-row { background: transparent; border-top: none; }
.summary-table .reading-row td { padding: 4pt 6pt 8pt 6pt; border-bottom: none; }

/* คำอ่านแบบเต็มความกว้าง */
.reading-full-width {
  color: #1e4d79;
  font-size: 8pt !important;
  font-style: italic;
  text-align: center;
  line-height: 1.2;
  margin: 0;
  padding: 0;
  width: 100%;
  white-space: normal;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* สำหรับ compact mode */
.summary-table.summary-compact .reading-full-width { font-size: 7.5pt !important; }

/* กรณีบังคับบรรทัดเดียว */
.reading-full-width.single-line { white-space: nowrap; overflow: visible; text-overflow: unset; }

/* ลดระยะห่างด้านล่างของแถวยอดรวมให้ชิดกับคำอ่าน */
.summary-table .total-row td { padding-bottom: 6pt; }

@media print {
  .reading-full-width { font-size: 7pt !important; line-height: 1.1; }
  .summary-table.summary-compact .reading-full-width { font-size: 6.5pt !important; }
}

/* Compact mode */
.summary-table.summary-compact { 
  font-size: 9pt; 
}

.summary-table.summary-compact td,
.summary-table.summary-compact th { 
  font-size: 9pt !important; 
  padding: 4pt 5pt;
}

.summary-table.summary-compact .total-row .summary-label,
.summary-table.summary-compact .total-row .summary-amount { 
  font-size: 9.5pt !important; 
}

.summary-table.summary-compact .reading {
  font-size: 7pt !important;
}

/* เพิ่มการจัดการสำหรับข้อความยาวในภาษาไทย */
.thai-text-break {
  word-break: break-all;
  overflow-wrap: anywhere;
}

/* กำหนดความกว้างสูงสุดสำหรับคำอ่าน */
.reading-container {
  max-width: 100%;
  overflow: hidden;
}

/* ป้องกันการล้นของตัวเลขจำนวนเงิน */
.amount-container {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

/* สำหรับจำนวนเงินที่มีหลายหลัก */
.large-amount {
  font-size: 9pt !important;
}

/* แก้ไขเพิ่มเติมสำหรับ mPDF ที่อาจมีปัญหากับ table layout */
.summary-notes-table td {
  box-sizing: border-box;
  overflow: hidden;
}

/* Fallback สำหรับกรณีที่ข้อความยาวเกินไป */
.text-ellipsis {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* เพิ่มกฎเฉพาะสำหรับ mPDF ที่มีปัญหากับ text overflow */
@media print {
  .summary-notes-table {
    border-spacing: 6pt 0;
  }
  
  .panel-notes {
    width: 38% !important;
  }
  
  .panel-box:last-child {
    width: 57% !important;
  }
  
  .summary-table .summary-label {
    width: 42% !important;
    font-size: 9.5pt;
  }
  
  .summary-table .summary-amount {
    width: 58% !important;
    font-size: 9.5pt;
  }
  
  .reading {
    font-size: 7.5pt !important;
    line-height: 1.0 !important;
  }
  
  .summary-amount .amount-main {
    font-size: 9.5pt;
  }
}